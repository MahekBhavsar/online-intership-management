<div class="container mt-4">

  <h4 class="mb-3">Application Management</h4>

  <div class="table-responsive">
    <table class="table table-bordered table-hover align-middle text-center">

      <thead class="table-dark">
        <tr>
          <th>User</th>
          <th>Course</th>
          <th>Assign Staff</th>
          <th>Action</th>
        </tr>
      </thead>

      <tbody>
        @for (app of applications(); track app.id) {

          <tr>

            <td>{{ app.userId }}</td>
            <td>{{ app.courseId }}</td>

            <!-- Assign Staff -->
            <td>
              <select
                class="form-select form-select-sm"
                #staffSelect
                [disabled]="app.status !== 'approved'"
                (change)="assignStaff(app, staffSelect.value)">

                <option value="">Select Staff</option>

                @for (staff of staffs; track staff.staffId) {
                  <option
                    [value]="staff.staffId"
                    [selected]="staff.staffId === app.assignedStaffId">
                    {{ staff.staffName }}
                  </option>
                }
              </select>
            </td>

            <td>
              <button
                class="btn btn-sm btn-success me-2"
                (click)="approveApplication(app)"
                [disabled]="app.status !== 'pending'">
                Approve
              </button>

              <button
                class="btn btn-sm btn-danger"
                (click)="rejectApplication(app)"
                [disabled]="app.status !== 'pending'">
                Reject
              </button>
            </td>

          </tr>
        }
      </tbody>

    </table>
  </div>

</div>