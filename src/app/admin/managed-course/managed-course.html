<div class="container-fluid p-0 d-flex vh-100 overflow-hidden">
  
  <app-admin-sidebar></app-admin-sidebar>

  <div class="flex-grow-1 bg-light overflow-auto d-flex flex-column">

    <app-admin-topnav></app-admin-topnav>

    <div class="p-4 p-lg-5">
      
      <div class="row align-items-center mb-4">
        <div class="col">
          <h1 class="h3 fw-bold text-dark mb-1">Course Management</h1>
          <p class="text-secondary mb-0">Create and assign staff to training modules.</p>
        </div>
      </div>

      <div class="row g-4">
        <div class="col-xl-4">
          <div class="card shadow-sm border-0 rounded-4">
            <div class="card-body p-4">
              <h5 class="fw-bold mb-4 text-primary">Add New Course</h5>

              <form [formGroup]="courseForm" (ngSubmit)="submit()">

                <div class="mb-3">
                  <label class="form-label fw-semibold small">Course Name</label>
                  <input
                    type="text"
                    class="form-control form-control-lg fs-6"
                    formControlName="courseName"
                    placeholder="Enter course name"
                  />
                </div>

                <div class="mb-3">
                  <label class="form-label fw-semibold small">Duration</label>
                  <select class="form-select" formControlName="duration">
                    <option value="">Select Duration</option>
                    <option value="1 Month">1 Month</option>
                    <option value="3 Months">3 Months</option>
                    <option value="6 Months">6 Months</option>
                    <option value="Custom">Custom</option>
                  </select>
                </div>

                @if (courseForm.get('duration')?.value === 'Custom') {
                  <div class="mb-3">
                    <label class="form-label fw-semibold small text-primary">Specify Custom Duration</label>
                    <input
                      type="text"
                      class="form-control"
                      formControlName="customDuration"
                      placeholder="e.g. 45 Days"
                    />
                  </div>
                }

                <div class="mb-4">
                  <label class="form-label fw-semibold small">Assign Primary Staff</label>
                  <select class="form-select" formControlName="staffId">
                    <option value="">Select Staff Member</option>
                    @for (s of (staffList$ | async); track s.staffId) {
                      <option [value]="s.staffId">{{ s.staffName }}</option>
                    }
                  </select>
                </div>

                <button
                  class="btn btn-primary w-100 py-2 fw-bold rounded-pill shadow-sm"
                  type="submit"
                  [disabled]="courseForm.invalid"
                >
                  <i class="fas fa-save me-2"></i> Save Course
                </button>
              </form>
            </div>
          </div>
        </div>

        <div class="col-xl-8">
          <div class="card shadow-sm border-0 rounded-4 h-100">
            <div class="card-body p-4">
              <h5 class="fw-bold mb-4">Managed Courses</h5>

              <div class="table-responsive">
                <table class="table table-hover align-middle">
                  <thead class="table-light border-0">
                    <tr>
                      <th class="ps-3">Course Detail</th>
                      <th>Lead Instructor</th>
                      <th>Timeframe</th>
                    </tr>
                  </thead>

                  <tbody>
                    @for (c of (courses$ | async); track c.id) {
                      <tr>
                        <td class="ps-3 fw-bold text-dark">{{ c.courseName }}</td>
                        <td>
                           <div class="d-flex align-items-center">
                             <div class="bg-primary-subtle text-primary rounded-circle me-2 d-flex align-items-center justify-content-center" style="width: 30px; height: 30px; font-size: 0.8rem;">
                               <i class="fas fa-user"></i>
                             </div>
                             {{ c.assignedStaffName }}
                           </div>
                        </td>
                        <td>
                          <span class="badge bg-light text-dark border fw-normal">{{ c.duration }}</span>
                        </td>
                      </tr>
                    } @empty {
                      <tr>
                        <td colspan="3" class="text-center py-5 text-muted">
                          <i class="fas fa-folder-open d-block mb-2 fs-2 opacity-25"></i>
                          No courses available.
                        </td>
                      </tr>
                    }
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div> </div> </div> </div>